<?xml version="1.0" encoding="UTF-8"?>
<update xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.ofw.fi/xml/2011/java-xmldb-updater/UpdaterSchema.xsd">

  <sql>alter table WorkspaceMaterialEvaluation add column evaluationType varchar(255) not null;</sql>
  <sql>alter table WorkspaceMaterialEvaluation add column archived bit not null;</sql>
  
  <sql>update WorkspaceMaterialEvaluation set evaluationType = 'ASSESSMENT';</sql>
  <sql>update WorkspaceMaterialEvaluation set archived = false;</sql>

  <sql>
  CLEANUP PREVIOUS EXPERIMENT
  drop table SupplementationRequestAudioClip;
  CLEANUP PREVIOUS EXPERIMENT
  </sql>


  <sql>
  TODO
  insert into WorkspaceMaterialEvaluation (studentEntityId, workspaceMaterialId, assessorEntityId, verbalAssessment, evaluated, evaluationType, archived)
    select studentEntityId, workspaceMaterialId, userEntityId, requestText, requestDate, 'SUPPLEMENTATIONREQUEST', archived
    from SupplementationRequest
    where workspaceMaterialId is not null;
  TODO 
  </sql>
  
  <sql>
  TODO
  delete from SupplementationRequest where workspaceMaterialId is not null;
  TODO
  </sql>
  
  <sql>
  TODO
  alter table SupplementationRequest drop column workspaceMaterialId;
  TODO
  </sql>
  
  <sql>
  TODO
  alter table SupplementationRequest drop index sr_student_material;
  TODO
  </sql>
</update>